## Чистка Битрикс от вирусов

Чаще всего попадаются сайты с вирусами на решениях от АСПРО или с модулем от esolutions.

1. В shell-консоли:
   1. смотрим запущенные процессы ps auxf | grep userId.
   2. удаляем подозрительные процессы kill -9 processId.
2. Проверить настройки крона. Сделать это можно командой "crontab -l" на сервере или в панели.
3. Часто права у папок и файлов изменены, меняем на 755 или 777.
4. Проверяем файлы .htaccess:
   1. Если нет доступа в админку:
      1. Удаляем корневой .htaccess.
      2. Если не помогло запускаем файл deleteAllHtaccess.php.
   2. Запускаем проверку .htaccess в админке "Рабочий стол - Настройки - Проактивная защита - Поиск троянов - Проверка .htaccess". По необходимости можно "Удалить всё и установить минимальный набор".
5. Запускаем поиск троянов "Рабочий стол - Настройки - Проактивная защита - Поиск троянов - Сканирование файлов".
6. Обновляем Битрикс.
7. Обновляем решения, если не куплены обновления, лечим патчерами:
   1. АСПРО -  https://aspro.ru/news/vzlomy-saytov-aspro/
   2. esolutions - https://esolutions.su/bezopastnost-saytov/